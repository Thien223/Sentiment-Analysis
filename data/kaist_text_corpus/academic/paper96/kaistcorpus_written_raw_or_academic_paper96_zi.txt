<language> Korean </language>
<textcode> KSC-5601-1988 </textcode>
<process> raw </process>
<version> 2001(or)</version>
<filename> kaistcorpus_written_raw_or_academic_paper96_zi.txt </filename>
<title> 주파수 영역에서 파선추적을 이용한 유사파형 역산 </title>
<author> 신성렬 </author>
<date> 1993</date>
<publisher> 서울대학교 </publisher>
<kdc> TD559.6254 </kdc>
<tdmsfiletext>
    초 록

   석유탐사를 목적으로한 탄성파 탐사에서 지층의 구간속도 및 구간별 속도분포는 중합, 구조보정, 심도변환의 결과에 가장 큰 영향을 미치는 요소이며 자료해석 시에 암상을 추측할 수 있는 중요한 요소이다. 파선추적을 이용하여 신속하게 파선경로 및 주시을 계산할 수 있는 반사주시 역산법(traveltime inversion)의 장점과 저주파수 대역으로부터 구간속도에 대한 정보를 획득할 수 있는 파형역산법(full waveform inversion)의 장점을 취하여 두 가지 역산법의 절충형태인 유사파형역산법(pseudo full waveform inversion)을 개발하여 지하의 속도모델을 보다 정확하게 추정하였다. 이 때 모델의 구간속도는 각 지층내에서 균질하며, 지층의 경계면은 여러개의 직선으로 근사 구성되고, 수진된 모든 반사파의 진폭과 위상이 일정하다고 가정하였다.

   측정치는 발췌된 주시를 주파수영역으로 변환시켜 구하며, 이론치는 파선추적을 이용하여 계산된 반사주시를 주파수영역으로 변환시켜 구하였다. 자코비안은 이론치 계산과 동시에 파선경로로부터 해석적으로 직접 구하기 때문에 신속한 역산이 가능하였으며, 역산은 감쇠최소자승법을 이용하여 주파수영역에서 수행되었다. 목적함수(objective function)의 주파수 특성을 고찰한 결과 저주파수 대역에서는 수렴반경이 넓고 함수값이 평활하여 수렴속도가 빠르며, 고주파수 대역에서는 수렴반경이 좁지만 분해능이 높아짐을 알 수 있었다. 저주파수 대역부터 역산을 시작하여 주파수대역을 증가시키는 역산기법은 역산의 안정성과 효율을 향상시킬 수 있었다. 상부층의 역산변수를 결정한 다음 하부층을 결정하는 순차적인 역산기법과 반복횟수에 따라 역산변수를 교대로 선택하는 역산기법을 도입하여 역산의 안정성을 향상시켰다.

   파선추적법과 유한차분법을 이용하여 구한 이론자료 및 한반도 대륙붕의 현장자료에 대하여 유사파형 역산법을 적용한 결과 현장적용 가능성과 역산의 안정성 및 타당성이 확인되었다. 역산된 속도모델은 탄성파 구조해석 및 층서해석에 직접 이용될 수 있으며 속도모델에 기초한 중합 및 구조보정(model based stack and migration)과 선중합 구조보정(prestack migration)에 이용되어 지하의 영상품질을 향상시킬 수 있을 것이라 기대된다.

주요어 : 속도모델, 유사파형 역산법, 파선추적, 자코비안, 주파수영역, 감쇠최소자승법, 저주파수대역, 안정성, 발췌, 반사주시
1. 서 론

   탄성파탐사는 석유탐사분야를 위시하여 천해저 지질조사 및 부지조사등 제반 공학적인 문제에 널리 사용되는 탐사방법으로서 취득한 자료로부터 적절한 자료처리과정을 거친 후 중합단면도를 작성하거나 지질구조를 영상화하여 해석을 실시한다. 탄성파 반사법에서 구간속도 및 구간별 속도분포는 중합, 구조보정, 심도변환의 결과에 가장 큰 영향을 미치는 요소이다. 구간속도를 결정할 수 있는 가장 손쉬운 방법은 Dix공식을 이용하는 것으로 지층의 경계면이 수평층이고 각 지층내의 속도가 일정하며 음원과 수진기의 거리가 짧다고 가정하여 구한다(Dix, 1955; Al-Chalabi, 1974). 그러나 지질구조가 복잡한 조건에서는 상기 방법의 적용은 부적절하며 더욱 정확한 역산법에 의한 속도모델의 추정이 요구된다.  
    측정된 반사주시나 파동장으로부터 구간속도 및 심도를 결정하는 역산문제는 일반적으로 파동방정식에 대한 그린함수(Green's function)를 구하는 방법에 따라 역산방법이 결정된다. 반사주시 역산법(traveltime inversion)은 파동방정식의 그린함수를 고주파수 극한상태(high frequency limit)에서 구하며, 파형역산법(full waveform inversion)은 그린함수를 저주파수 대역에서 구한다.
   파형역산법은 선형역산과 비선형역산으로 분류되며 선형역산은 약산란을 가정한 Born근사를 이용한다(Clayton등, 1981; Berkhout, 1984,1986; Tarantola, 1984a; Bleistein등, 1985). 비선형역산은 파동방정식의 Adjoint operater의 특성을 이용하여 잔여치를 역전파시킨 파동장과 virtual source를 곱하여 gradient를 구하는 반복적인 역산법이다(Tarantola, 1984b,1986). 비선형역산에 대한 연구는 시간영역 음향파동방정식의 유한차분법(Kolb등, 1986), 탄성파동방정식의 유한차분법(Mora, 1987), 주파수영역 유한요소법으로 자코비안을 구하여 감쇠최소자승법의 비선형역산(Shin, 1988), 시추공 대 시추공에서 주파수영역 유한차분법(Pratt등, 1990)등 주로 합성탄성파 기록자료에 대하여 비선형 역산을 적용하였다. 이후 시추공 대 시추공 현장자료에 대하여 토모그라피와 유한차분법을 이용한 파형역산을 결합시킨 방법으로 시추공 사이의 속도분포를 구하는 연구(Zhou등, 1993)등이 있었다. 파형역산법은 저주파수 대역에서 구간속도에 대한 정보를 안정적이며 정확하게 획득할 수 있는 장점을 가지고 있다. 그러나 송신파형(source wavelet)의 추정문제, 탄성파동의 비선형 거동 및 이론치를 구하기 위하여 유한요소법, 유한차분법, 경계적분법등을 사용하므로 방대한 계산시간이 소요되는 등의 단점으로 인하여 현재의 컴퓨터 발전속도에 비추어 볼 때 석유탐사 현장자료에 대한 적용은 향후에나 가능할 것으로 생각된다.
   파동방정식의 그린함수를 고주파수 극한상태에서 구하는 파선추적법은 계산시간이 빠르다는 장점 때문에 탄성파 반사주시 역산에 널리 사용되고 있다. 측정된 주시와 파선추적을 이용하여 계산한 주시의 차이를 반복적인 역산을 통하여 최소화 시키거나(Gjoystdal등, 1981; Bishop 등, 1985; Chiu등, 1987; Lin, 1989; 김유성, 1992; Lines등, 1993) 또는 파선추적으로부터 계산된 주시에 추정된 송신파형을 콘볼루션한 뒤 측정자료와의 상관도(Coherency)를 최대화 시키는 방법(Landa등, 1988,1989,1991,1993; Reshef등, 1991; Sorin등, 1993)등이 있다. 반사주시 역산법은 측정된 주시의 오차 및 선정되는 초기치에 매우 민감하여 역산이 불안정하는 단점이 있으며, 상관도를 최대화 시키는 역산법은 발췌과정이 필요 없다는 장점이 있으나 다중반사파 및 파형의 변화는 오차로 작용하여 해의 정확도를 감소시키며 또한 역산의 수렴속도가 매우 느리기 때문에 많은 반복횟수가 필요한 단점이 있다.
   자코비안의 사용 유무에 따라 역산방법을 분류할 때 자코비안을 이용하는 방법으로는 수렴속도가 늦지만 국부적 최소값에라도 항상 수렴하는 최대경사법, 수렴속도가 빠르지만 발산할 가능성이 있는 가우스-뉴턴법, 두 가지 방법의 장점을 취한 감쇠최소자승법등이 있으며, 이 방법은 비교적 해의 수렴속도가 빠르나 자코비안을 구하기 힘들다는 단점이 있다(Lines and Treitel, 1984). 자코비안을 이용하지 않는 방법은 무작위 검색법(random search)인  Monte-Carlo법(Rothman, 1984)이 있으며 수렴속도가 매우 늦기 때문에 많은 반복회수를 필요로하는 단점이 있다.
   비선형역산은 많은 반복 계산을 필요로하기 때문에 이론치는 효과적이며 신속하게 계산되어야 하고 또한 역산이 안정적이어야 한다. 따라서 본 연구에서는 파선추적을 이용하여 빠른 시간내에 이론치를 계산하는 반사주시 역산법의 장점과 저주파수 성분으로부터 구간속도에 대한 정보를 획득할 수 있으며 역산이 안정적인 파형역산법의 장점을 취하여 상기 두 가지 역산법의 절충형태인 유사파형 역산법(pseudo full waveform inversion)을 개발하였다.
   본 연구에서는 모델의 구간속도가 각 구간내에서 균질하며, 지층의 경계면은 여러개의 직선으로 구성되며, 반사파의 진폭 및 위상의 변화가 없다고 가정하였다. 파동장이나 반사주시는 속도, 밀도, 흡수계수등 지하매질의 물성 및 지층 경계면의 좌표에 관한 함수이며, 파동방정식을 풀 때 주파수 대역만 달리하는 그린함수이므로 파선추적법중 하나인 발사법(shooting ray tracing)을 이용하여 계산된 반사주시를 주파수영역으로 변환시켜 효과적이고 빠른 시간에 전파형(full waveform)과 유사한 파동장을 구하였다. 주파수영역 유한요소법을 이용하여 파형역산을 수행할 경우 매 반복마다 필요한 이론치 계산 이외에도 자코비안을 구하기 위한 계산이 한번 더 필요하다(Shin 1988). 그러나 파선추적을 이용하여 이론치 계산과 동시에 해석적 자코비안을 직접 구하면 역산과정에서 매우 많은 시간을 절약할 수 있을 것이다. 본 연구의 역산은 해석적 자코비안을 구하여 감쇠최소자승법으로 주파수영역에서 수행하였다. 파선추적으로 구한 해석적 자코비안을 검증하기 위하여 각 역산변수 및 각 주파수 대역에 따라 차분법으로 구한 자코비안과 비교 검토하였며 목적함수의 주파수 특성을 고찰하였다.
   경사모델, 향사 및 배사구조모델, 핀치아웃모델, 복합구조모델, 렌즈모델, 구조보정 단면도로부터 추출된 모델등 다양한 지질학적 모델에 대하여 파선추적으로 구한 이론자료를 가지고 유사파형 역산법을 적용하였으며, 역산의 안정성을 향상시키기 위하여 다양한 역산기법을 도입하였다. 현장자료에 대한 적용 전단계로서 현장적용에서의 문제점을 개선하고 현장적용성을 검토하기 위하여 유한차분법으로 구한 이론자료에 대하여 유사파형 역산법을 적용하였다. 반사주시를 신속하고 용이하게 발췌하기 위하여 속도스펙트럼상에서 영점거리 주시 및 속도를 발췌하였으며 쌍곡선식에 따라 각 채널별 반사주시로 재구성 하였다. 마지막으로 유사파형 역산법의 현장적용 가능성 및 타당성을 검토하기 위하여 현장자료에 대하여 본 역산법을 적용하였다. 역산된 속도모델은 탐사자료에 인접한 시추공의 음파검층 기록자료와 비교 검토되었다.

2. 이  론

2-1. 역산이론

   지표나 시추공에서 측정되는 반사주시나 파동장은 속도, 밀도, 흡수계수등 지하매질의 물성과 음원 및 수진기의 위치에 관한 함수다. 탄성파 역산이란 측정된 자료로부터 속도, 심도, 밀도, 흡수계수등과 같은 매개변수를 정량적으로 해석하는 기법이다. 그러나 매개변수와 그 반응(model response)이 비선형이기 때문에 측정치와 이론치의 오차를 최소화시키는 매개변수를 찾아내는 반복적 비선형 역산법이 필요하다. 역산의 수학적원리는 Jackson(1972), Aki and Richards(1980), Lines and Treitel(1984), Menke(1984)등에서 설명된 바 있으며 중력역산(Oldenburg, 1974), 전자기역산(Jupp and Vozoff, 1975)등 다양한 지구물리학적 역산문제에서 논의된 바 있다.
   측정된 탄성파 자료벡터 d가 개, 역산하고자 하는 모델의 매개변수 벡타 p가 개로 구성되어 있고, 모델에 대한 반응인 이론치를 벡타 u라 하면 아래와 같이 나타낼 수 있다. 
                   d                             (1)
                   u                             (2)
                   p                              (3)
이때, 는 전치행렬(transpose matrix)이다.
모델을 결정하는 매개변수 의 초기치를 , 이때의 이론치 벡타를 u0라하고 u를 p0에 대하여 1차항까지 테일러 급수전개하면 아래와 같다.
                   u = u0 +                          (4)
                                        p=p0

간단히 행렬식으로 나타내면 아래와 같다.
                   u = u0 + Jp                                      (5)
이때, J는  크기의 자코비안행렬이며,  p는 매개변수의 변화량을 나타내는 벡타로서 아래와 같다.
                                                          (6)
                                                           (7)
자코비안행렬 J는 일반적으로 정방행렬이 아니고, 특이(singular)하여 역행렬이 존재하지 않을 수 있으며, 매개변수의 갯수보다 측점의 갯수가 많은() overdetermined 경우가 대부분이다.
   최적화이론에 따라 측정치와 이론치의 오차 제곱합을 최소화 시키는 매개변수를 선택해야 되며 오차벡타 e는 아래와 같이 정의된다. 
                   e = d - u                                        (8)
식(5)와 식(8)을 결합하면 다음과 같다.
                   d - u0 =  Jp + e                               (9)
초기치에 대한 모델의 이론치와 측정치의 차이를 잔차벡타 g라고 하면 g = d - u0이며  식(9)는 아래와 같다.             
                   e = g - Jp                               (10)
   최소자승 또는 가우스-뉴턴(Gauss-Newton)법은 매개변수의 변화벡타 p에 관하여 오차제곱합 S = eTe를 최소화 시키는 것이므로 S는 식(10)으로부터 다음과 같이 나타낼 수 있다.
                   S = (g - Jp)T (g - Jp)                       (11)
S의 최소값은 p에 대하여 미분하였을 때 0이 된다. 즉,
                                                           (12)
이다. 식(11)을 식(12)에 대입하여 정리하면 아래의 정규방정식(normal equation)을 유도할 수 있다. 
                   JTJp = JTg                                (13)
이로부터 식(11)로 정의되는 오차제곱합을 최소화시키는 매개변수의 변화량을 계산할 수 있다.
                   p = (JTJ)-1JTg                             (14)
식(14)의 매개변수 변화벡타 p는 제한조건(unconstrained)이 없을 때 가우스-뉴턴법으로 구한 최소자승해지만 행렬 JTJ의 역행렬이 존재하지 않거나, 역행렬이 존재하더라도 초기치 u0가 참값으로부터 멀리 떨어져 있어 오차벡타가 클 경우 발산할 가능성이 있으며 수렴속도가 늦게된다. 이런 바람직하지 못한 현상을 방지하기 위하여 Levenberg(1944)는 매개변수 변화벡타의 에너지, 즉 제곱합이 일정한 유한값 범위에 있어야 한다는 제한조건을 도입하였다. 이러한 제한조건을 더하면 매개변수 변화벡타가 무제한 진동되는 것이 방지되며, 평활화 된다. 식(11)에 매개변수 변화벡타의 크기를 제한하는 조건을 도입하면 아래와 같이 나타낼 수 있다.
       S = (g - Jp)T (g - Jp) + (pTp-p2   )              (15)
이때, 를 감쇠인자(damping factor) 또는 Lagrange multiplier라 한다.
식(15)를 p에 대하여 미분한 후 정리하면 아래와 같다.
                (JTJ + I)p = JTg                         (16)
                p = (JTJ + I)-1JTg                        (17)
식(16)은 비선형 문제를 선형화 시킨 것이며, 식(17)을 이용하여 해를 구하는 방법을 능선회귀법(ridge regression), 감쇠최소자승법(damped least squares), 또는 Marquart-Levenberg법이라고 한다. 정방대칭행렬인  JTJ의 대각요소에 더해진 감쇠인자는 이 행렬이 특이하게 되는 것을 방지하며, 수렴할 경우 감쇠인자의 크기를 줄이고 발산할 경우 증가시키므로 감쇠최소자승법은 최대경사법과 최소자승법의 복합적 특성을 갖는다.  
   한편, 최대경사법은 오차제곱의 등치곡면에 수직으로  감소방향을 설정하여 오차제곱이 최소가될 때까지 반복 수행하여 일정한 수렴조건을 만족하는 매개변수를 구하는 방법으로서, 결과적으로 매개변수 변화벡타는 아래와 같다.
                   pg = 2JTg                                 (18)
최대경사법은 초기치가 참값과 차이가 클 때 효과적이며 수렴속도는 느리지만 국부적인 최소값에라도 항상 수렴한다. 
   Full Newton법은 심한 비선형문제에도 잘 적용되어지는 역산법으로(Dennis등 1983), 제곱오차를 2차항까지 테일러 급수전개한 뒤 Euler정리에 따라 식을 정리하면 매개변수 변화벡타는 아래와 같이 표시된다. 
                (JTJ + R)p = -JTg                         (19)
이때, (JTJ + R)을 헤시안행렬(Hessian matrix)이라 하며, 행렬 R은 아래와 같다.
                   

</tdmsfiletext>
